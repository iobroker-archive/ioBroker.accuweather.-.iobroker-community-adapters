{
  "version": 3,
  "sources": ["../../src/lib/nexthour-obj.ts"],
  "sourcesContent": ["import type Accuweather from '../main';\r\n\r\nexport async function createSummaryObjects(adapter: Accuweather): Promise<void> {\r\n    const obj = (await import('../../lib/summaryObject.json')) as unknown as {\r\n        default: {\r\n            [key: string]: ioBroker.StateObject;\r\n        };\r\n    };\r\n    await adapter.extendObject('Summary', {\r\n        type: 'channel',\r\n        common: {\r\n            name: 'Weather Summary',\r\n        },\r\n        native: {},\r\n    });\r\n    const _obj = Object.assign({}, obj.default);\r\n\r\n    for (const key in _obj) {\r\n        const k = key as keyof typeof _obj;\r\n        const stateObj = _obj[k];\r\n        if (stateObj && stateObj.common && stateObj.common.unit) {\r\n            stateObj.common.unit = metric2Imperial(adapter, stateObj.common.unit);\r\n        }\r\n        await adapter.extendObject(key, stateObj);\r\n    }\r\n}\r\n\r\nexport async function createNextHourForecatObjects(hour: string, adapter: Accuweather): Promise<void> {\r\n    const obj = await import('../../lib/nextHourObject.json');\r\n    await adapter.extendObject(`Hourly.h${hour}`, {\r\n        type: 'channel',\r\n        common: {\r\n            name: `Hour ${hour} Forecast`,\r\n        },\r\n        native: {},\r\n    });\r\n    const _obj = Object.assign({}, obj.default) as unknown as {\r\n        [key: string]: ioBroker.StateObject;\r\n    };\r\n\r\n    for (const k in _obj) {\r\n        const key = k as keyof typeof _obj;\r\n        const measure: any = {};\r\n\r\n        // only use nextHour definitions\r\n        if (!String(key).startsWith('nextHour')) {\r\n            continue;\r\n        }\r\n        const nkey = String(key).replace('nextHour', `Hourly.h${hour}`);\r\n        const role = _obj[key].common.role;\r\n        _obj[key].common.unit = metric2Imperial(adapter, _obj[key].common.unit);\r\n        measure[nkey] = Object.assign({}, _obj[key]);\r\n        measure[nkey].common = Object.assign({}, _obj[key].common);\r\n        if (measure[nkey].common.role) {\r\n            measure[nkey].common.role = `${role}.forecast.${hour}`;\r\n        }\r\n        adapter.log.debug(`key: ${nkey}, role:${JSON.stringify(measure[nkey].common.role)}, base: ${role}`);\r\n        await adapter.extendObject(nkey, measure[nkey]);\r\n    }\r\n}\r\n\r\nexport async function createCurrentConditionObjects(adapter: Accuweather): Promise<void> {\r\n    const obj = (await import('../../lib/currentCondObject.json')) as unknown as {\r\n        default: {\r\n            [key: string]: ioBroker.StateObject;\r\n        };\r\n    };\r\n    await adapter.extendObject('Current', {\r\n        type: 'channel',\r\n        common: {\r\n            name: 'Current Conditions',\r\n        },\r\n        native: {},\r\n    });\r\n\r\n    for (const key in obj.default) {\r\n        const k = key as keyof typeof obj.default;\r\n        const stateObj = obj.default[k];\r\n        if (stateObj && stateObj.common && stateObj.common.unit) {\r\n            stateObj.common.unit = metric2Imperial(adapter, stateObj.common.unit);\r\n        }\r\n        await adapter.extendObject(key.replace('nextHour', 'Current'), stateObj);\r\n    }\r\n}\r\n\r\nexport async function createDailyForecastObjects(adapter: Accuweather): Promise<void> {\r\n    const obj = await import('../../lib/DailyObject.json');\r\n    for (let i = 1; i <= 5; i++) {\r\n        await adapter.extendObject(`Daily.Day${i}`, {\r\n            type: 'channel',\r\n            common: {\r\n                name: `Day ${i} Forecast`,\r\n            },\r\n            native: {},\r\n        });\r\n        const _obj = Object.assign({}, obj.default) as unknown as {\r\n            [key: string]: ioBroker.StateObject;\r\n        };\r\n\r\n        for (const k in _obj) {\r\n            const key = k as keyof typeof _obj;\r\n            const measure: any = {};\r\n            let nkey = '';\r\n            const role = _obj[key].common.role;\r\n            _obj[key].common.unit = metric2Imperial(adapter, _obj[key].common.unit);\r\n            if (!String(key).indexOf('dayPart.')) {\r\n                nkey = String(key).replace('dayn.', `Day${i}.`);\r\n                measure[nkey] = Object.assign({}, _obj[key]);\r\n                measure[nkey].common = Object.assign({}, _obj[key].common);\r\n                if (measure[nkey].common.role) {\r\n                    measure[nkey].common.role = `${role}.forecast.${i - 1}`;\r\n                }\r\n                await adapter.extendObject(nkey, measure[nkey]);\r\n            } else {\r\n                ['Day', 'Night'].forEach(dp => {\r\n                    nkey = String(key).replace('dayn.', `Day${i}.`).replace('dayPart.', `${dp}.`);\r\n                    measure[nkey] = Object.assign({}, _obj[key]);\r\n                    measure[nkey].common = Object.assign({}, _obj[key].common);\r\n                    if (measure[nkey].common.role) {\r\n                        measure[nkey].common.role = `${role}.forecast.${i - 1}`;\r\n                    }\r\n                    adapter.extendObject(nkey, measure[nkey]).catch(() => {});\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport async function createHourlyForecastObjects(adapter: Accuweather): Promise<void> {\r\n    for (let hr = 0; hr < 24; hr++) {\r\n        await createNextHourForecatObjects(String(hr), adapter);\r\n    }\r\n}\r\n\r\nfunction metric2Imperial(adapter: Accuweather, unit: string | undefined): string | undefined {\r\n    if (unit === undefined || adapter.config.metric === 'Metric') {\r\n        return unit;\r\n    }\r\n    switch (unit) {\r\n        case '\u00B0C':\r\n            return 'F';\r\n        case 'km/h':\r\n            return 'mi/h';\r\n        case 'km':\r\n            return 'mi';\r\n        case 'm':\r\n            return 'ft';\r\n        case 'mb':\r\n            return 'inHg';\r\n        case 'mm':\r\n            return 'in';\r\n        default:\r\n            return unit;\r\n    }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,eAAsB,qBAAqB,SAAqC;AAC5E,QAAM,MAAO,MAAM,6CAAO,8BAA8B;AAKxD,QAAM,QAAQ,aAAa,WAAW;AAAA,IAClC,MAAM;AAAA,IACN,QAAQ;AAAA,MACJ,MAAM;AAAA,IACV;AAAA,IACA,QAAQ,CAAC;AAAA,EACb,CAAC;AACD,QAAM,OAAO,OAAO,OAAO,CAAC,GAAG,IAAI,OAAO;AAE1C,aAAW,OAAO,MAAM;AACpB,UAAM,IAAI;AACV,UAAM,WAAW,KAAK,CAAC;AACvB,QAAI,YAAY,SAAS,UAAU,SAAS,OAAO,MAAM;AACrD,eAAS,OAAO,OAAO,gBAAgB,SAAS,SAAS,OAAO,IAAI;AAAA,IACxE;AACA,UAAM,QAAQ,aAAa,KAAK,QAAQ;AAAA,EAC5C;AACJ;AAEA,eAAsB,6BAA6B,MAAc,SAAqC;AAClG,QAAM,MAAM,MAAM,6CAAO,+BAA+B;AACxD,QAAM,QAAQ,aAAa,WAAW,IAAI,IAAI;AAAA,IAC1C,MAAM;AAAA,IACN,QAAQ;AAAA,MACJ,MAAM,QAAQ,IAAI;AAAA,IACtB;AAAA,IACA,QAAQ,CAAC;AAAA,EACb,CAAC;AACD,QAAM,OAAO,OAAO,OAAO,CAAC,GAAG,IAAI,OAAO;AAI1C,aAAW,KAAK,MAAM;AAClB,UAAM,MAAM;AACZ,UAAM,UAAe,CAAC;AAGtB,QAAI,CAAC,OAAO,GAAG,EAAE,WAAW,UAAU,GAAG;AACrC;AAAA,IACJ;AACA,UAAM,OAAO,OAAO,GAAG,EAAE,QAAQ,YAAY,WAAW,IAAI,EAAE;AAC9D,UAAM,OAAO,KAAK,GAAG,EAAE,OAAO;AAC9B,SAAK,GAAG,EAAE,OAAO,OAAO,gBAAgB,SAAS,KAAK,GAAG,EAAE,OAAO,IAAI;AACtE,YAAQ,IAAI,IAAI,OAAO,OAAO,CAAC,GAAG,KAAK,GAAG,CAAC;AAC3C,YAAQ,IAAI,EAAE,SAAS,OAAO,OAAO,CAAC,GAAG,KAAK,GAAG,EAAE,MAAM;AACzD,QAAI,QAAQ,IAAI,EAAE,OAAO,MAAM;AAC3B,cAAQ,IAAI,EAAE,OAAO,OAAO,GAAG,IAAI,aAAa,IAAI;AAAA,IACxD;AACA,YAAQ,IAAI,MAAM,QAAQ,IAAI,UAAU,KAAK,UAAU,QAAQ,IAAI,EAAE,OAAO,IAAI,CAAC,WAAW,IAAI,EAAE;AAClG,UAAM,QAAQ,aAAa,MAAM,QAAQ,IAAI,CAAC;AAAA,EAClD;AACJ;AAEA,eAAsB,8BAA8B,SAAqC;AACrF,QAAM,MAAO,MAAM,6CAAO,kCAAkC;AAK5D,QAAM,QAAQ,aAAa,WAAW;AAAA,IAClC,MAAM;AAAA,IACN,QAAQ;AAAA,MACJ,MAAM;AAAA,IACV;AAAA,IACA,QAAQ,CAAC;AAAA,EACb,CAAC;AAED,aAAW,OAAO,IAAI,SAAS;AAC3B,UAAM,IAAI;AACV,UAAM,WAAW,IAAI,QAAQ,CAAC;AAC9B,QAAI,YAAY,SAAS,UAAU,SAAS,OAAO,MAAM;AACrD,eAAS,OAAO,OAAO,gBAAgB,SAAS,SAAS,OAAO,IAAI;AAAA,IACxE;AACA,UAAM,QAAQ,aAAa,IAAI,QAAQ,YAAY,SAAS,GAAG,QAAQ;AAAA,EAC3E;AACJ;AAEA,eAAsB,2BAA2B,SAAqC;AAClF,QAAM,MAAM,MAAM,6CAAO,4BAA4B;AACrD,WAAS,IAAI,GAAG,KAAK,GAAG,KAAK;AACzB,UAAM,QAAQ,aAAa,YAAY,CAAC,IAAI;AAAA,MACxC,MAAM;AAAA,MACN,QAAQ;AAAA,QACJ,MAAM,OAAO,CAAC;AAAA,MAClB;AAAA,MACA,QAAQ,CAAC;AAAA,IACb,CAAC;AACD,UAAM,OAAO,OAAO,OAAO,CAAC,GAAG,IAAI,OAAO;AAI1C,eAAW,KAAK,MAAM;AAClB,YAAM,MAAM;AACZ,YAAM,UAAe,CAAC;AACtB,UAAI,OAAO;AACX,YAAM,OAAO,KAAK,GAAG,EAAE,OAAO;AAC9B,WAAK,GAAG,EAAE,OAAO,OAAO,gBAAgB,SAAS,KAAK,GAAG,EAAE,OAAO,IAAI;AACtE,UAAI,CAAC,OAAO,GAAG,EAAE,QAAQ,UAAU,GAAG;AAClC,eAAO,OAAO,GAAG,EAAE,QAAQ,SAAS,MAAM,CAAC,GAAG;AAC9C,gBAAQ,IAAI,IAAI,OAAO,OAAO,CAAC,GAAG,KAAK,GAAG,CAAC;AAC3C,gBAAQ,IAAI,EAAE,SAAS,OAAO,OAAO,CAAC,GAAG,KAAK,GAAG,EAAE,MAAM;AACzD,YAAI,QAAQ,IAAI,EAAE,OAAO,MAAM;AAC3B,kBAAQ,IAAI,EAAE,OAAO,OAAO,GAAG,IAAI,aAAa,IAAI,CAAC;AAAA,QACzD;AACA,cAAM,QAAQ,aAAa,MAAM,QAAQ,IAAI,CAAC;AAAA,MAClD,OAAO;AACH,SAAC,OAAO,OAAO,EAAE,QAAQ,QAAM;AAC3B,iBAAO,OAAO,GAAG,EAAE,QAAQ,SAAS,MAAM,CAAC,GAAG,EAAE,QAAQ,YAAY,GAAG,EAAE,GAAG;AAC5E,kBAAQ,IAAI,IAAI,OAAO,OAAO,CAAC,GAAG,KAAK,GAAG,CAAC;AAC3C,kBAAQ,IAAI,EAAE,SAAS,OAAO,OAAO,CAAC,GAAG,KAAK,GAAG,EAAE,MAAM;AACzD,cAAI,QAAQ,IAAI,EAAE,OAAO,MAAM;AAC3B,oBAAQ,IAAI,EAAE,OAAO,OAAO,GAAG,IAAI,aAAa,IAAI,CAAC;AAAA,UACzD;AACA,kBAAQ,aAAa,MAAM,QAAQ,IAAI,CAAC,EAAE,MAAM,MAAM;AAAA,UAAC,CAAC;AAAA,QAC5D,CAAC;AAAA,MACL;AAAA,IACJ;AAAA,EACJ;AACJ;AAEA,eAAsB,4BAA4B,SAAqC;AACnF,WAAS,KAAK,GAAG,KAAK,IAAI,MAAM;AAC5B,UAAM,6BAA6B,OAAO,EAAE,GAAG,OAAO;AAAA,EAC1D;AACJ;AAEA,SAAS,gBAAgB,SAAsB,MAA8C;AACzF,MAAI,SAAS,UAAa,QAAQ,OAAO,WAAW,UAAU;AAC1D,WAAO;AAAA,EACX;AACA,UAAQ,MAAM;AAAA,IACV,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX;AACI,aAAO;AAAA,EACf;AACJ;",
  "names": []
}
